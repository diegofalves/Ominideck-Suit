<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, user-scalable=yes">
  <meta name="version" content="2022.3.0">
  <link rel="StyleSheet" href="../template/styles/topic.min.css" type="text/css">
  <link rel="StyleSheet" data-skin="true" type="text/css" href="../template/bluelagoon_-_redwood/layout.css">
  <link rel="StyleSheet" data-skin="true" href="../template/bluelagoon_-_redwood/userstyles.css" type="text/css">
  
  <script data-relpath=".." src="../template/scripts/csh-redirect.js" type="text/javascript"></script>
<link rel="StyleSheet" href="../assets/css/redwood.css" type="text/css">
  <meta name="template" content="../assets/masterpages/configuration and administration.htt">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="topic-status" content="Ready for Review">
  <meta name="topic-priority" content="0">
  <meta name="topic-time-estimate" content="0">
  <meta name="topic-comment" content>
  <meta name="topic-id" content="configuration\how_to_set_up_and_execute_cr_aggregation.htm">
  <meta http-equiv="Content-Language" content="en-US">
  <meta name="generator" content="Adobe RoboHelp 2022">
  <title>Setup for Using SharePoint with OTM</title>
  <link rel="StyleSheet" href="../assets/css/redwood.css" type="text/css">
  <script type="text/javascript" language="JavaScript1.2" src="../assets/js/feedback.js"></script>
  <meta name="rh-index-keywords" content="about trade agreement qualification">
<meta name="rh-version" content="2022.6.34"><meta name="description" content>
  
  
  
  
  <style>
  </style>
  <link rel="stylesheet" type="text/css" href="../assets/css/redwood.css">
<meta name="rh-version" content="2022.6.34">
    <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
    <meta name="dcterms.created" content="2025-07-16T17:04:08+00:00">
    <meta name="dcterms.title" content="Online Help for Transportation and Global Trade Management">
    <meta name="dcterms.category" content="cloud">
    <meta name="dcterms.isVersionOf" content="OTMOL">
    <meta name="dcterms.product" content="en/cloud/saas/transportation/25c">
    <meta name="dcterms.identifier" content="G28971-02">
    <meta name="dcterms.release" content="Release 25C">
  <script id="ssot-metadata" type="application/json">{"primary":{"category":{"short_name":"cloud","element_name":"Cloud","display_in_url":true},"suite":{"short_name":"saas","element_name":"Cloud Applications","display_in_url":true},"product_group":{"short_name":"supply-chain-management","element_name":"Supply Chain Management","display_in_url":false},"product":{"short_name":"transportation","element_name":"Transportation and Global Trade Management Cloud","display_in_url":true},"release":{"short_name":"25c","element_name":"Release 25C","display_in_url":true}}}</script>
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"WebPage","name":"Setup for Using SharePoint with OTM","description":"","datePublished":"2025-07-16 CST","dateModified":"2025-07-16 CST"}</script>
    <script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>

<body class="rh-BODY-wrapper">
  <div class="cookie-widget-holder" id="cookie-status-widget-holder"></div>
  <div class="RH-LAYOUT-HEADER-skip-content-container" id="skip-to-content"></div>
  <header class="RH-LAYOUT-HEADER-container" role="banner">
    <div class="RH-LAYOUT-HEADER-logo-box  ">
      <div class="RH-LAYOUT-HEADER-logo" id="logo-holder"></div>
      <div class="RH-LAYOUT-HEADER-title" id="topic-title-holder"></div>
    </div>
    <div class="RH-LAYOUT-HEADERMENU-container" id="header-menu"></div>
    <div class="search-placeholder-class" id="search-with-help"></div>
  </header>
  <main role="main" class="RH-LAYOUT-BODY-container">
    <div class="RH-LAYOUT-SEARCHRESULTS" id="rh-searchresults"></div>
    <div class="RH-LAYOUT-LEFTPANEL-container" id="rh-leftpanel"></div>
    <div class="rh-layout-BODY-main" id="rh-layout-main">
      <div class="RH-LAYOUT-TOOLBAR-toolbar-box" id="rh-toolbar"></div>
      <div class="rh-layout-BODY-body">
        <div class="RH-LAYOUT-CENTERPANEL-container">
          <div class="rh-layout-selectdetails" id="rh-selectdetails"></div>
          <div class="RH-LAYOUT-CENTERPANEL-topic-box" id="rh-topic">
  <div>
    <p class="Header">Configuration and Administration</p>
  </div>
  <div><noscript>
    If you have any questions or comments about this topic or the online help,
    please <a href="mailto:otm-doc_us@oracle.com?subject=Documentation feedback:OTM Help">contact
      us.</a>
  </noscript>
  <h1><span data-field="title" data-format="default">Setup for Using SharePoint with OTM</span></h1>
  <div role="main">
    <p>Oracle Transportation Management (OTM) can use Microsoft SharePoint Online, hosted on Azure Cloud, as an external data storage system to store documents as part of content management system (CMS).</p>
    <p>This page briefly describes the steps performed to connect to Microsoft SharePoint Online using Microsoft Graph API.</p>
    <p>First of all, you need to register the application in the Azure Active Directory (AAD) portal. OTM will communicate with SharePoint Online by means of this application.</p>
    <p>Once the application is registered, you will have to configure a <span class="Bold">Client Secret</span> for the application which will be used for authentication purposes.Â This can be achieved by creating a new Client Secret under &quot;<span class="Bold">Certificates and Secrets</span>&quot; in the Azure Active Directory (AAD) Â portal.</p>
    <p>You will also have to provide adequate permissions to the newly registered application so that the Microsoft Graph API calls work.</p>
    <p>This can be achieved via <span class="Bold">API Permissions &gt; Add a Permission &gt; Microsoft Graph</span>, and then selecting the required permissions from &quot;<span class="Bold">Delegated Permissions</span>&quot; and &quot;<span class="Bold">Application Permissions</span>&quot;.</p>
    <p>Once the permissions are granted, the application is ready for use. You will have the following details generated once the application is registered:</p>
    <ul>
      <li><span class="Bold">Application (client) ID</span></li>
      <li><span class="Bold">Directory (tenant) ID</span></li>
      <li><span class="Bold">Secret Value</span> (obtained while creating the Client Secret)</li>
    </ul>
    <p>These will be required for the next steps where you will configure OTM to work with SharePoint Online.</p>
    <p>The various API endpoints are as follow where each endpoint includes a <span class="Bold">Permissions</span> section, where you can find details on the required access levels. This section displays both the <span class="Bold">Least Privileged Permissions</span> and the <span class="Bold">Higher Privileged Permissions</span>.</p>
    <ul>
      <li><span class="Bold">Get Drive Item</span>: https://learn.microsoft.com/en-us/graph/api/driveitem-get?view=graph-rest-1.0&amp;tabs=http</li>
      <li><span class="Bold">Upload or replace the contents of a </span><span class="Bold">driveItem</span>:Â https://learn.microsoft.com/en-us/graph/api/driveitem-put-content?view=graph-rest-1.0&amp;tabs=http</li>
      <li><span class="Bold">driveItem: </span><span class="Bold">createUploadSession</span>:Â https://learn.microsoft.com/en-us/graph/api/driveitem-createuploadsession?view=graph-rest-1.0</li>
      <li><span class="Bold">Delete Item</span>: https://learn.microsoft.com/en-us/graph/api/driveitem-delete?view=graph-rest-1.0&amp;tabs=http</li>
    </ul>
    <h2><a id="Setting_Up_an_External_System_In_OTM"></a>Setting Up an External System In OTM</h2>
    <p>You will be required to configure an <a href="../communication/contact_manager/new_external_system.htm">external system</a> in OTM that will enable you to authenticate/interact with SharePoint Online.</p>
    <p>The input fields should be set as follows:</p>
    <ul>
      <li><span class="Bold">Authentication Type</span>: OAuth 2.0 - Client Credentials</li>
      <li><span class="Bold">Authorization Service Authentication Type</span>: Microsoft Graph API</li>
      <li><span class="Bold">Client ID</span>: Provide the <span class="Bold">Application (client) ID</span> value generated after registering the application</li>
      <li><span class="Bold">Client Secret</span>: Provide the <span class="Bold">Secret Value</span> generated after registering the application</li>
      <li><span class="Bold">Authorization Service URL</span>: https://login.microsoftonline.com/<span class="Bold">{Directory (tenant) ID}</span>/oauth2/v2.0/token (replace <span class="Bold">{Directory (tenant) ID}</span> with the actual value)</li>
      <li><span class="Bold">Application Scope</span>: https://graph.microsoft.com/.default</li>
      <li><span class="Bold">URL</span>: https://graph.microsoft.com/v1.0/drives (acts as Â a base URL for all API requests)</li>
    </ul>
    <h2><a id="Setting_Up_Content_Management__System_In_OTM"></a>Setting Up Content Management Â System In OTM</h2>
    <p>You have to configure a <a href="../planning/power_data/documents/content_management_system.htm">Content Management System (CMS)</a> in OTM for SharePoint Online.Â The input fields should be set as follows:</p>
    <ul>
      <li><span class="Bold">System Type</span>: SharePoint Online</li>
      <li><span class="Bold">External System</span>: Select the External System created in the above section</li>
      <li><span class="Bold">Drive ID</span>: This represents the location where the documents will be stored . The drive ID to be used can be obtained by means of an API call. Microsoft Graph provides certain ways to obtain the drive ID. You can refer to Microsoft documentation for Microsoft Graph APIs (Microsoft Graph &gt; Â v1.0 reference &gt; Â Files &gt; Drives &gt; Â Get drive) to check for the various ways to obtain the drive ID. Following is one such way:
        <ol>
          <li><span class="Bold">Obtain the OAuth token</span>: You need to obtain an authentication token which will be used in API request to fetch the drive ID.
            <p><span class="Bold">Request</span>:</p>
            <p><span class="Code">curl -X POST &quot;https://login.microsoftonline.com/{Directory (tenant) ID}/oauth2/v2.0/token&quot; -H &quot;Content-Type: application/x-www-form-urlencoded&quot; -d &quot;grant_type=client_credentials&amp;client_id={Application (client) ID}&amp;client_secret={Secret Value}&amp;scope=https://graph.microsoft.com/.default</span></p>
            <p><span class="Bold"><br>
                Response</span><span class="Code">:</span></p>
            <p><span class="Code">{<br>
                Â  Â  &quot;token_type&quot;:&quot;Bearer&quot;,<br>
                Â  Â  &quot;expires_in&quot;:3599,<br>
                Â  Â  &quot;ext_expires_in&quot;:3599,<br>
                Â  Â  &quot;access_token&quot;:&quot;abcdef123&quot;<br>
                <br>
                }</span><span class="Code"></span></p>
            <p class="Note"><span class="Bold">Note</span>: Replace <span class="Bold">{Directory (tenant) ID}</span>, <span class="Bold">{Application (client) ID}</span>, and <span class="Bold">{Secret Value}</span> with actual values.</p>
          </li>
          <li><span class="Bold">Make API call to obtain drive ID</span>: Now you will have to make the API call to fetch the Â drive using the <span class="Bold">access_token</span> that you obtained in the previous step.
            <p><span class="Bold">Request</span>:</p>
            <p><span class="Code">curl -X GET &quot;https://graph.microsoft.com/v1.0/drives&quot; -H &quot;Content-Type: application/json&quot; -H &quot;Authorization: Bearer abcdef123&quot;</span></p>
            <p><span class="Bold"><br>
                Response</span>:</p>
            <p><span class="Code">{<br>
                Â  Â  &quot;@odata.context&quot;:&quot;https://graph.microsoft.com/v1.0/$metadata#drives&quot;,<br>
                Â  Â  &quot;value&quot;:[<br>
                Â  Â  Â  Â  {<br>
                Â  Â  Â  Â  Â  Â  &quot;createdDateTime&quot;:&quot;2019-11-17T07:53:03Z&quot;,<br>
                Â  Â  Â  Â  Â  Â  &quot;description&quot;:&quot;&quot;,<br>
                Â  Â  Â  Â  Â  Â  &quot;id&quot;:&quot;j!33fffsdtyaouwwbnbcypdhdhddhhhddjdjkkak&quot;,<br>
                Â  Â  Â  Â  Â  Â  &quot;lastModifiedDateTime&quot;:&quot;2021-08-17T21:47:34Z&quot;,<br>
                Â  Â  Â  Â  Â  Â  &quot;name&quot;:&quot;Documents&quot;,<br>
                Â  Â  Â  Â  Â  Â  &quot;webUrl&quot;:&quot;https://abc.sharepoint.com/someLocation&quot;,<br>
                Â  Â  Â  Â  Â  Â  &quot;driveType&quot;:&quot;documentLibrary&quot;,<br>
                Â  Â  Â  Â  Â  Â  &quot;createdBy&quot;:{<br>
                Â  Â  Â  Â  Â  Â  Â  Â  &quot;user&quot;:{<br>
                Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &quot;displayName&quot;:&quot;System Account&quot;<br>
                Â  Â  Â  Â  Â  Â  Â  Â  }<br>
                Â  Â  Â  Â  Â  Â  },<br>
                Â  Â  Â  Â  Â  Â  &quot;lastModifiedBy&quot;:{<br>
                Â  Â  Â  Â  Â  Â  Â  Â  &quot;user&quot;:{<br>
                Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &quot;email&quot;:&quot;xyz@abc.onmicrosoft.com&quot;,<br>
                Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &quot;displayName&quot;:&quot;ABC XYZ&quot;<br>
                Â  Â  Â  Â  Â  Â  Â  Â  }<br>
                Â  Â  Â  Â  Â  Â  },<br>
                Â  Â  Â  Â  Â  Â  &quot;owner&quot;:{<br>
                Â  Â  Â  Â  Â  Â  Â  Â  &quot;group&quot;:{<br>
                Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &quot;id&quot;:&quot;************************&quot;,<br>
                Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &quot;displayName&quot;:&quot;&quot;<br>
                Â  Â  Â  Â  Â  Â  Â  Â  }<br>
                Â  Â  Â  Â  Â  Â  },<br>
                Â  Â  Â  Â  Â  Â  &quot;quota&quot;:{<br>
                Â  Â  Â  Â  Â  Â  Â  Â  &quot;deleted&quot;:67680990,<br>
                Â  Â  Â  Â  Â  Â  Â  Â  &quot;remaining&quot;:27487671942107,<br>
                Â  Â  Â  Â  Â  Â  Â  Â  &quot;state&quot;:&quot;normal&quot;,<br>
                Â  Â  Â  Â  Â  Â  Â  Â  &quot;total&quot;:27487790694400,<br>
                Â  Â  Â  Â  Â  Â  Â  Â  &quot;used&quot;:48729447<br>
                Â  Â  Â  Â  Â  Â  }<br>
                Â  Â  Â  Â  }<br>
                Â  Â  ]<br>
                <br>
                }</span><span class="Code"></span></p>
            <p>Here the value of &quot;id&quot; parameter in response &quot;j!33fffsdtyaouwwbnbcypdhdhddhhhddjdjkkak&quot; denotes the Drive ID.</p>
          </li>
        </ol>
      </li>
    </ul>
  </div>
  <h2>Related Topics</h2>
  <p class="LinkList"><a href="../communication/contact_manager/new_external_system.htm">External System</a></p>
  <p class="LinkList"><a href="../planning/power_data/documents/content_management_system.htm">Content Management System</a></p>
  <script type="text/javascript" language="JavaScript1.2">
    //<![CDATA[
    if (typeof(InitEffects) != 'function') InitEffects = new Function();
    InitEffects('P1');
    //]]>
  </script>

</div>
  <div>
    <hr align="center">
    <p class="Footer"><img align="right" alt="Was this page helpful? Click to send feedback." height="49" src="../assets/images/feedback.png" style="font-family: &quot;Oracle Sans&quot;, -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; font-size: medium;" usemap="#imagemap" width="322"><map data-img-height="49" data-img-width="322" name="imagemap"><area alt="How can we improve this page?" coords="222, 1, 265, 43" href="javascript:sendDownFeedback()" shape="rect" title="How can we improve this page?"><area alt="What did you like about this page?" coords="273, 4, 317, 45" href="javascript:sendUpFeedback()" shape="rect" title="What did you like about this page?"><area alt="Comments" coords="41, 3, 218, 45" href="javascript:sendFeedback()" shape="rect" title="Comments"></map></p>
  </div>

</div>
          <div class="RH-LAYOUT-BRS-container" id="rh-brs"></div>
        </div>
        <div class="RH-LAYOUT-RIGHTPANEL-container" id="rh-rightpanel"></div>
      </div>
    </div>
  </main>
  <footer role="contentinfo" class="RH-LAYOUT-FOOTER-container" id="rh-footer">
  <table border="0" cellpadding="1" cellspacing="1" class="table-unstyled">
    <tbody>
      <tr>
        <td style="background-color:#312D2A">
          <p class="Footer">Other Documentation Resources</p>
          <p class="Footer"><a href="https://docs.oracle.com/pls/topic/lookup?ctx=otm-latest&amp;id=otm-gs" target="_blank" title="Transportation and Global Trade Management Library">Help Center &amp; Guides</a>Â â¢ <a href="https://support.oracle.com/support/?documentId=KB153929" target="_blank" title="My Oracle Support">Extra Documents</a>Â â¢Â <a href="https://support.oracle.com/support/?documentId=KA171" target="_blank" title="Information Center">Information Center</a></p>
        </td>
        <td style="background-color:#312D2A">
          <p class="Footer"><a href="../general/cpyr.htm">CopyrightÂ Â© 2001, <span data-field="date" data-format="YYYY">2025</span>, Oracle and/or its affiliates.</a></p>
        </td>
        <td style="background-color:#312D2A">
          <p class="Footer">Contact Oracle</p>
          <p class="Footer"><a href="https://support.oracle.com" target="_blank">Contact Support</a> â¢ <a class="footer" href="javascript:sendFeedback()" target="_blank" title="Report an issue in the help or guides">Contact Documentation</a></p>
        </td>
      </tr>
    </tbody>
  </table>

</footer>
  <script type="text/javascript">//<![CDATA[

    gRootRelPath = ".."
    gCommonRootRelPath = ".."
    gTopicId = "31.9_60"
  
//]]></script>


  <script src="../template/scripts/topicpage.js"></script>
  <script src="../whxdata/layoutconfig.js"></script>
  <script src="../whxdata/brsdata.js"></script>

  
    
      
          

            
              
                <link rel="StyleSheet" href="../template/bluelagoon_-_redwood/custom.css" type="text/css">
                
                  


</body></html>