<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, user-scalable=yes">
  <meta name="version" content="2022.3.0">
  <link rel="StyleSheet" href="../../template/styles/topic.min.css" type="text/css">
  <link rel="StyleSheet" data-skin="true" type="text/css" href="../../template/bluelagoon_-_redwood/layout.css">
  <link rel="StyleSheet" data-skin="true" href="../../template/bluelagoon_-_redwood/userstyles.css" type="text/css">
  
  <script data-relpath="../.." src="../../template/scripts/csh-redirect.js" type="text/javascript"></script>
<link rel="StyleSheet" href="../../assets/css/redwood.css" type="text/css">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="topic-priority" content="0">
  <meta name="topic-time-estimate" content="0">
  <meta name="topic-comment" content>
  <meta name="topic-id" content="Bulk Rating Actions">
  <meta name="topic-check-list" content="First Draft">
  <meta name="topic-status" content="Complete">
  <meta name="template" content="../../assets/masterpages/operational planning.htt">
  <meta http-equiv="Content-Language" content="en-US">
  <meta name="generator" content="Adobe RoboHelp 2022">
  <title>Bulk Plan Multi-stop Shipment Clustering Merge Algorithm</title>
  <link rel="StyleSheet" href="../../assets/css/redwood.css" type="text/css">
  <script type="text/javascript" language="JavaScript1.2" src="../../assets/js/feedback.js"></script>
  <meta name="rh-index-keywords" content="algorithms:clustering merge,clustering merge algorithm,bulk plan multi-stop shipment:clustering merge algorithm">
<meta name="rh-version" content="2022.6.34"><meta name="description" content>
  
  
  
  
  <style>
  </style>
  <link rel="stylesheet" type="text/css" href="../../assets/css/redwood.css">
<meta name="rh-version" content="2022.6.34">
    <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
    <meta name="dcterms.created" content="2025-07-16T17:04:07+00:00">
    <meta name="dcterms.title" content="Online Help for Transportation and Global Trade Management">
    <meta name="dcterms.category" content="cloud">
    <meta name="dcterms.isVersionOf" content="OTMOL">
    <meta name="dcterms.product" content="en/cloud/saas/transportation/25c">
    <meta name="dcterms.identifier" content="G28971-02">
    <meta name="dcterms.release" content="Release 25C">
  <script id="ssot-metadata" type="application/json">{"primary":{"category":{"short_name":"cloud","element_name":"Cloud","display_in_url":true},"suite":{"short_name":"saas","element_name":"Cloud Applications","display_in_url":true},"product_group":{"short_name":"supply-chain-management","element_name":"Supply Chain Management","display_in_url":false},"product":{"short_name":"transportation","element_name":"Transportation and Global Trade Management Cloud","display_in_url":true},"release":{"short_name":"25c","element_name":"Release 25C","display_in_url":true}}}</script>
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"WebPage","name":"Bulk Plan Multi-stop Shipment Clustering Merge Algorithm","description":"","datePublished":"2025-07-16 CST","dateModified":"2025-07-16 CST"}</script>
    <script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>

<body class="rh-BODY-wrapper">
  <div class="cookie-widget-holder" id="cookie-status-widget-holder"></div>
  <div class="RH-LAYOUT-HEADER-skip-content-container" id="skip-to-content"></div>
  <header class="RH-LAYOUT-HEADER-container" role="banner">
    <div class="RH-LAYOUT-HEADER-logo-box  ">
      <div class="RH-LAYOUT-HEADER-logo" id="logo-holder"></div>
      <div class="RH-LAYOUT-HEADER-title" id="topic-title-holder"></div>
    </div>
    <div class="RH-LAYOUT-HEADERMENU-container" id="header-menu"></div>
    <div class="search-placeholder-class" id="search-with-help"></div>
  </header>
  <main role="main" class="RH-LAYOUT-BODY-container">
    <div class="RH-LAYOUT-SEARCHRESULTS" id="rh-searchresults"></div>
    <div class="RH-LAYOUT-LEFTPANEL-container" id="rh-leftpanel"></div>
    <div class="rh-layout-BODY-main" id="rh-layout-main">
      <div class="RH-LAYOUT-TOOLBAR-toolbar-box" id="rh-toolbar"></div>
      <div class="rh-layout-BODY-body">
        <div class="RH-LAYOUT-CENTERPANEL-container">
          <div class="rh-layout-selectdetails" id="rh-selectdetails"></div>
          <div class="RH-LAYOUT-CENTERPANEL-topic-box" id="rh-topic">
  <div>
    <p class="Header">Operational Planning</p>
  </div>
  <div><noscript>
    If you have any questions or comments about this topic or the online help,
    please <a href="mailto:otm-doc_us@oracle.com?subject=Documentation feedback:OTM Help">contact
      us.</a>
  </noscript>
  <h1><span data-field="title" data-format="default">Bulk Plan Multi-stop Shipment Clustering Merge Algorithm</span></h1>
  <div role="main">
    <p>The clustering merge algorithm is selected by setting the multi-stop logic configuration parameter, <a href="../../planning/power_data/planning/logic_configuration_multistop.htm#consolidation_algorithm_type">MULTISTOP CONSOLIDATION ALGORITHM TYPE</a>, to Clustering Merge.</p>
    <p>While most of the OTM multistop algorithms merge only two shipments at a time (so that combining N shipments into one shipment would take N-1 merge operations), this algorithm has the capability to combine any number of shipments in a single merge operation. This helps achieve significant performance improvement over all other algorithms, particularly in creating multistop shipments with a large number of stops.</p>
    <p>OTM provides two clustering building algorithms: Legacy Cluster Building Algorithm and MIP Cluster Building Algorithm.</p>
    <p>There are related Multistop Cluster Merge parameters in <a href="../../planning/power_data/planning/logic_configuration_multistop.htm">Logic Configuration - Multistop parameters</a>.</p>
    <p>There are related glog.business.consolidation.multistop.clusterMerge in <a href="../../properties/glog/business.property.htm">glog.business Properties</a> as well as the property <a href="../../properties/glog/business.property.htm#consolidation.multistop.doSavingsMergeAfterClusterMerge">glog.business.consolidation.multistop.doSavingsMergeAfterClusterMerge</a>.</p>
    <h2><a id="legacy"></a>Legacy Cluster Building Algorithm</h2>
    <p>The legacy cluster building algorithm is where OTM implements the Sweep algorithm.</p>
    <p>The Sweep algorithm is appropriate for multistop scenarios in which shipments will have one pickup stop and many delivery stops, or many pickup stops and one delivery stop. Under certain simplifying assumptions, this algorithm may perform better than other algorithms. The assumptions include that order time windows and compatibilities do not determine how orders are consolidated onto shipments.</p>
    <p>For example, in the single pickup and multiple delivery scenario, this algorithm first forms clusters of delivery stops, and then merges the delivery stops into a single shipment for each cluster. Â Note that these clusters are chosen such that all the delivery stops in a cluster would combine to form one shipment.</p>
    <p>The clusters are formed using a Sweep algorithm, which sweeps clockwise from the single pickup location, and accounts for equipment capacity in terms of weight, volume, and equipment reference unit.</p>
    <p>In the first diagram, the source hub is surrounded by many delivery locations.</p>
    <p><img alt="In the first diagram, the source hub is surrounded by many delivery locations." class="Flow" src="../../assets/images/cluster_sweep_locations.svg"></p>
    <p>In the second diagram, the delivery locations are grouped into clusters.</p>
    <p><img alt="In the second diagram, the delivery locations are grouped into clusters." class="Flow" src="../../assets/images/cluster_sweep_stops.svg"></p>
    <p>In the third diagram, the clusters are each made into shipments which are processed in a clockwise sweep.</p>
    <p><img alt="In the third diagram, the clusters are each made into shipments which are processed in a clockwise sweep." class="Flow" src="../../assets/images/cluster_sweep_shipments.svg"></p>
    <p></p>
    <h2><a id="mip"></a>MIP Cluster Building Algorithm</h2>
    <p>The MIP Cluster Building Algorithm is a more sophisticated cluster forming algorithm in the sense that it considers all the compatibilities among direct shipments and supports more general multiple pick-up multiple drop off scenario. More importantly, it provides much more flexibility on how the cluster is formed by using the concept of similarity.</p>
    <p>In the first diagram, the source hub is near many delivery locations.</p>
    <p><img alt="In the first diagram, the source hub is near many delivery locations." class="Flow" src="../../assets/images/mip_cluster_sweep_locations.svg"></p>
    <p>In the second diagram, the algorthm has grouped the delivery locations into different clusters.</p>
    <p><img alt="In the second diagram, the algorthm has grouped the delivery locations into different clusters." class="Flow" src="../../assets/images/mip_cluster_sweep_stops.svg"></p>
    <p>In the third diagram, each cluster is processed as a shipment.</p>
    <p><img alt="In the third diagram, each cluster is processed as a shipment." class="Flow" src="../../assets/images/mip_cluster_sweep_shipments.svg"></p>
    <p>Similarity between two shipments</p>
    <p>The similarity between two shipments is determined by the linear combination of the certain weighted criteria. OTM takes distance saving, time window, rate, equipment and priority into consideration. These are defined by <a href="../../planning/power_data/planning/logic_configuration_multistop.htm">Multistop Logic Configuration</a> parameters. You should not enable all the criteria (i.e., should not set a positive value for the weights): the weights should be set based on business scenarios. The parameters are</p>
    <ul>
      <li><a href="../../planning/power_data/planning/logic_configuration_multistop.htm#MULTISTOP_DISTANCE_METRIC_WEIGHT">MULTISTOP DISTANCE METRIC WEIGHT</a></li>
      <li><a href="../../planning/power_data/planning/logic_configuration_multistop.htm#MULTISTOP_EQUIPMENT_METRIC_WEIGHT">MULTISTOP EQUIPMENT METRIC WEIGHT</a></li>
      <li><a href="../../planning/power_data/planning/logic_configuration_multistop.htm#MULTISTOP_PRIORITY_METRIC_WEIGHT">MULTISTOP PRIORITY METRIC WEIGHT</a></li>
      <li><a href="../../planning/power_data/planning/logic_configuration_multistop.htm#MULTISTOP_RATE_METRIC_WEIGHT">MULTISTOP RATE METRIC WEIGHT</a></li>
      <li><a href="../../planning/power_data/planning/logic_configuration_multistop.htm#MULTISTOP_TIME_WINDOW_METRIC_WEIGHT">MULTISTOP TIME WINDOW METRIC WEIGHT</a></li>
    </ul>
    <p>The following examples provide insight into the use of these criteria.</p>
    <h3 id="ClusterMergeHelpPages-Scenario1:ClusterbasedonTime">Scenario 1: Cluster based on Time</h3>
    <p>The user has three types of orders: must-go (late delivery date is the same as the early pick-up date), should-go (late delivery date is one or two days after early pick-up date) and can-go (late delivery date is four or five days after early pick-up date). The business requirement is to put must-go orders into one shipment, and, if there is equipment capacity remaining, put some should-go or can-go orders into the shipment as well.</p>
    <p>OTM could realize the requirement by setting MULTISTOP TIME METRIC WEIGHT to be 1 and MULTISTOP DISTANCE METRIC WEIGHT to be 0.2. Thus, two direct shipments with more similar pick-up time windows would be considered more similar than two direct shipment with more different time windows, in spite of greater geographic closeness of the delivery stops. However, among shipments with the same time window, the geographically closer shipments should still be considered as more similar.</p>
    <h3 id="ClusterMergeHelpPages-Scenario2:ClusterbasedonCompatibleEquipment">Scenario 2: Cluster based on Compatible Equipment</h3>
    <p>The user needs to send goods from one depot to multiple destination in one region, and has two types of trucks, big trucks and small trucks, across that region. The challenge here is that certain locations can only handle small trucks due to facility constraints. The business requirement is to build multi-stop shipments based on the destination location equipment constraint, i.e. build small truck multi-stop shipments to send goods for all small truck locations, and build large truck multi-stop shipments for the remaining.</p>
    <p>OTM could realize the requirement by setting MULTISTOP EQUIPMENT METRIC WEIGHT to be 1 and MULTISTOP DISTANCE METRIC WEIGHT to be 0.2. Thus, two small truck shipment would be considered as more similar than one small truck shipment and one large truck shipment. Distance metric is still considered for building multi-stop shipment with good distance savings.</p>
    <h3 id="ClusterMergeHelpPages-Scenario3:ClusterbasedonCompatibleRate">Scenario 3: Cluster based on Compatible Rate</h3>
    <p>The user has two nearby regions, and has one carrier for each region. Though the rate of the multi-stop shipment is determined by the source and destination locations, you still do not want to build shipments that go back and fourth between two regions.</p>
    <p>OTM could realize the requirement by setting MULTISTOP EQUIPMENT RATE WEIGHT to be 1 and MULTISTOP DISTANCE METRIC WEIGHT to be 0.2. Thus, two shipments that are within one region is more similar than two shipments across two regions. Again, distance metric is still considered for building multi-stop shipment with good distance savings. Note that, in theory, the MIP Cluster Algorithm can handle up to one thousand direct shipment at the same time.</p>
    <h2><a id="multistop_cluster_merge_strategy"></a>Multistop Cluster Merge Strategy</h2>
    <p>The cluster merge algorithm can be divided into two major steps: forming clusters and building multi-stop shipments for those clusters. In the multi-stop shipment building process for a cluster, there could be cases where direct shipments fail to get merged onto the multi-stop shipment for that cluster. The parameter <a href="../../planning/power_data/planning/logic_configuration_multistop.htm#MULTISTOP_CLUSTER_MERGE_STRATEGY">MULTISTOP CLUSTER MERGE STRATEGY</a> is used to configure how OTM handles those failed-to-merge direct shipments.</p>
    <h2><a id="Cluster_Merge_Parameters_Tuning"></a> Cluster Merge Parameters Tuning</h2>
    <p>The cluster merge algorithm would significantly reduce the run time. However, in order to make sure it also produce high quality solutions, cluster merge parameter tuning is required.</p>
    <p>The multi-stop shipment building process can be divided into two parts: the cluster merge process and the savings merge process. The cluster merge mimics the nature of clustering problem that occur during the assignment decision based on similarity between a single shipment node and the shipment which serves as the cluster center candidate. Thus, OTM cannot do sequence related feasibility check during the assignment process. Even if the shipment building process could separate those infeasible shipment nodes, the general solution quality would not be satisfying. This section provides suggestions about how to tune cluster merge parameters.</p>
    <p>The system suggests to set the parameter <a href="../../planning/power_data/planning/logic_configuration_multistop.htm#MULTISTOP_USE_SAVINGS_MERGE_AFTER_CLUSTER_MERGE">MULTISTOP USE SAVINGS MERGE AFTER CLUSTER MERGE</a> to be &quot;3. Use concurrent saving after cluster merge&quot; to make the multi-stop shipment building process robust. In order to observe the intermediate result of clustering merge you need to set the parameter MULTISTOP USE SAVINGS MERGE AFTER CLUSTER MERGE to be &quot;1.Parameter tuning&quot;. Then, you can focus on the other parameters <a href="../../planning/power_data/planning/logic_configuration_multistop.htm#MULTISTOP_DISTANCE_METRIC_THRESHOLD">MULTISTOP DISTANCE METRIC THRESHOLD</a>, <a href="../../planning/power_data/planning/logic_configuration_multistop.htm#MULTISTOP_CLUSTER_MERGE_MIP_GENERAL_PENALTY">MULTISTOP CLUSTER MERGE MIP GENERAL PENALTY</a>, and similarity metric weights.</p>
    <p>Let&#39;s look at two scenarios to understand cluster merge parameter tuning:</p>
    <p><span class="Bold">Scenario 1: A complex multi-stop shipment</span></p>
    <p>The business requirement is when a shipment or locations has strict time window constraints; there are multiple pick-up and multiple drop-off locations or when a multi-segment multi-stop shipment is desired, the strategy is to use cluster merge to build multiple small clusters, then use savings merge to assemble them into a long multi-stop shipments.</p>
    <p>OTM could realize the requirement by setting the value of parameters MULTISTOP DISTANCE METRIC THRESHOLD and MULTISTOP CLUSTER MERGE MIP GENERAL PENALTY to a relatively low value, i.e. MULTISTOP DISTANCE METRIC THRESHOLD to be 0.3 and MULTISTOP CLUSTER MERGE MIP GENERAL PENALTY to be 0.5.</p>
    <p><span class="Bold">Scenario 2: Â A simple multi-stop shipment</span></p>
    <p>The business requirement is when there is a single pick-up and multiple drop-off or single drop-off and multiple pick-up scenario and a shipment time window is open, the strategy is to use cluster merge to build big clusters and then use savings merge to insert the remaining left over direct shipments into those big multi-stop shipments.</p>
    <p>OTM could realize the requirement by setting the value of parameters MULTISTOP DISTANCE METRIC THRESHOLD and MULTISTOP CLUSTER MERGE MIP GENERAL PENALTY to a relatively high value, i.e. MULTISTOP DISTANCE METRIC THRESHOLD to be 0.5 and MULTISTOP CLUSTER MERGE MIP GENERAL PENALTY to be 10.</p>
  </div>
  <h2>Related Topics</h2>
  <p class="LinkList"><a href="../bulk_plan_performance_and_tuning.htm">Bulk Plan Performance and Tuning Overview</a></p>
  <p class="LinkList"><a href="bulk_plan_solution_quality_tuning.htm">Bulk Plan Solution Quality Tuning</a></p>
  <p class="LinkList"><a href="bulk_plan_tuning_order_bundling_logic.htm">Bulk Plan Tuning Order Bundling Logic</a></p>
  <p class="LinkList"><a href="bulk_plan_tuning_direct_shipment_building.htm">Bulk Plan Tuning Direct Shipment Building</a></p>
  <p class="LinkList"><a href="bulk_plan_tuning_cont_opt_logic.htm">Bulk Plan Tuning Container Optimization Logic</a></p>
  <p class="LinkList"><a href="bulk_plan_tuning_continuous_moves_logic.htm">Bulk Plan Tuning Continuous Moves Logic</a></p>
  <p class="LinkList"><a href="../../assets/docs/bulk_plan_performance_and_tuning_guide.pdf">Bulk Plan Performance and Tuning PDF</a></p>
  <script type="text/javascript" language="JavaScript1.2">
    //<![CDATA[
    if (typeof(InitEffects) != 'function') InitEffects = new Function();
    InitEffects('P1');
    //]]>
  </script>

</div>
  <div>
    <hr align="center">
    <p class="Footer"><img align="right" alt="Was this page helpful? Click to send feedback." height="49" src="../../assets/images/feedback.png" style="font-family: &quot;Oracle Sans&quot;, -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; font-size: medium;" usemap="#imagemap" width="322"><map data-img-height="49" data-img-width="322" name="imagemap"><area alt="How can we improve this page?" coords="222, 1, 265, 43" href="javascript:sendDownFeedback()" shape="rect" title="How can we improve this page?"><area alt="What did you like about this page?" coords="273, 4, 317, 45" href="javascript:sendUpFeedback()" shape="rect" title="What did you like about this page?"><area alt="Comments" coords="41, 3, 218, 45" href="javascript:sendFeedback()" shape="rect" title="Comments"></map></p>
  </div>

</div>
          <div class="RH-LAYOUT-BRS-container" id="rh-brs"></div>
        </div>
        <div class="RH-LAYOUT-RIGHTPANEL-container" id="rh-rightpanel"></div>
      </div>
    </div>
  </main>
  <footer role="contentinfo" class="RH-LAYOUT-FOOTER-container" id="rh-footer">
  <table border="0" cellpadding="1" cellspacing="1" class="table-unstyled">
    <tbody>
      <tr>
        <td style="background-color:#312D2A">
          <p class="Footer">Other Documentation Resources</p>
          <p class="Footer"><a href="https://docs.oracle.com/pls/topic/lookup?ctx=otm-latest&amp;id=otm-gs" target="_blank" title="Transportation and Global Trade Management Library">Help Center &amp; Guides</a>Â â¢ <a href="https://support.oracle.com/support/?documentId=KB153929" target="_blank" title="My Oracle Support">Extra Documents</a>Â â¢Â <a href="https://support.oracle.com/support/?documentId=KA171" target="_blank" title="Information Center">Information Center</a></p>
        </td>
        <td style="background-color:#312D2A">
          <p class="Footer"><a href="../../general/cpyr.htm">CopyrightÂ Â© 2001, <span data-field="date" data-format="YYYY">2025</span>, Oracle and/or its affiliates.</a></p>
        </td>
        <td style="background-color:#312D2A">
          <p class="Footer">Contact Oracle</p>
          <p class="Footer"><a href="https://support.oracle.com" target="_blank">Contact Support</a> â¢ <a class="footer" href="javascript:sendFeedback()" target="_blank" title="Report an issue in the help or guides">Contact Documentation</a></p>
        </td>
      </tr>
    </tbody>
  </table>

</footer>
  <script type="text/javascript">//<![CDATA[

    gRootRelPath = "../.."
    gCommonRootRelPath = "../.."
    gTopicId = "1"
  
//]]></script>


  <script src="../../template/scripts/topicpage.js"></script>
  <script src="../../whxdata/layoutconfig.js"></script>
  <script src="../../whxdata/brsdata.js"></script>

  
    
      
          

            
              
                <link rel="StyleSheet" href="../../template/bluelagoon_-_redwood/custom.css" type="text/css">
                
                  


</body></html>